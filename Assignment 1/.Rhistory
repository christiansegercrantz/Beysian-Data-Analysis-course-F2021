gather("key", "value", c(inWard,inIcu)) %>%
filter(date > max(date)-60)
#rm(list = ls())
#setwd("~/GitHub/COVID-19-analysis")
library(tidyverse)
library(ggplot2)
library(purrr)
library(plotly)
library(jsonlite)
library(stringr)
theme_set(
theme_minimal() +
theme(legend.position = "right")
)
substrRight <- function(x, n){
substr(x, nchar(x)-n+1, nchar(x))
}
#Read in the material
#443686 for daily, 443702L for weekly
#445222L for hospital district, 445268L for municipality
tests_raw <- read.csv("https://sampo.thl.fi/pivot/prod/en/epirapo/covid19case/fact_epirapo_covid19case.csv?row=hcdmunicipality2020-445222L&column=dateweek20200101-509030&filter=measure-445356",sep=";", encoding = "UTF-8")
cases_raw <- read.csv("https://sampo.thl.fi/pivot/prod/en/epirapo/covid19case/fact_epirapo_covid19case.csv?row=hcdmunicipality2020-445222L&column=dateweek20200101-509030",sep=";", encoding = "UTF-8")
genders <- read.csv("https://sampo.thl.fi/pivot/prod/en/epirapo/covid19case/fact_epirapo_covid19case.csv?column=sex-444328",sep=";", encoding = "UTF-8")
self_made_tests_raw <- read.csv("https://sampo.thl.fi/pivot/prod/fi/epirapo/omaolosymp/fact_epirapo_omaolosymp.csv?column=dateweek2020010120201231-443686",sep=";", encoding = "UTF-8")
hospitalized_raw <- fromJSON("https://w3qa5ydb4l.execute-api.eu-west-1.amazonaws.com/prod/finnishCoronaHospitalData")[['hospitalised']]
# Data handling -----------------
tests_raw <- tests_raw %>%
mutate("id" = paste(Time, Area, sep = " "))
cases_raw <- cases_raw %>%
mutate("id" = paste(Time, Area, sep = " "))
finland <- inner_join(tests_raw, cases_raw, by="id") %>%
select(-ends_with("y"),"val.y", -"id") %>%
rename(Tests = val.x) %>%
rename(Cases = val.y) %>%
rename(Time = Time.x) %>%
rename(Area = Area.x) %>%
filter(!is.na(Cases) | !is.na(Tests)) %>%
filter(Time != "Time")
finland_all <- finland %>%
filter(Area == "All areas") %>%
select(-Area) %>%
mutate(Week = paste0(substr(as.character(Time),6,9),".", substrRight(as.character(Time), 2))) %>%
mutate(Tests = replace(Tests, is.na(Tests), 0)) %>%
mutate(Index = row_number()) %>%
filter(Index >= 9)
finland_test <- finland %>%
filter(!is.na(Tests))
coeff = 1/0.03
finland_all.interp <- finland_all %>%
map_df(~data.frame(tests = approx(finland_all$Index, finland_all$Tests, n = 120),
cases = approx(finland_all$Index, finland_all$Cases, n = 120)))
# history <- 7
# future <- 2
# y <- head(tail(finland_all$Cases,history),-1)
# week <- head(tail(finland_all$Week,history),-1)
# model <- lm(y ~ log(week))
# newdata <- data.frame(week = append(week,nth(finland_all$Week, -2)+1:future))
# pred <- data.frame(predictions = predict(model,newdata=newdata), newdata)
#temp <- finland_all %>% select(Week,Tests,Cases) %>%
#  mutate(Week2 = Week) %>%
#  select(-Cases,Cases) %>%
#  rename_all(function(e){return (names(finland_all.interp))})
#finland_all.interp <- bind_rows(finland_all.interp,temp) %>%
#  arrange(tests.x)
# Plots ---------------
# tests_vs_cases <- ggplot(data=finland_all, aes(x=Week, group = 1, ) ) +
#                   geom_line(aes(y=Cases, col="Cases")) + geom_text(aes(label=Cases, y=Cases),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Cases)) +
#                   geom_line(aes(y=Tests/coeff, col="Tests")) + geom_text(aes(label=Tests, y=Tests/coeff),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Tests/coeff), col = "firebrick3") +
#                   scale_y_continuous(name = "Cases",sec.axis = sec_axis( trans=~.*coeff, name="Tests")) +
#                   geom_ribbon(data=finland_all.interp, aes(x = tests.x, ymin = cases.y, ymax = pmin(cases.y, tests.y/coeff), fill = paste("More than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
#                   geom_ribbon(data=finland_all.interp, aes(x = cases.x, ymin = tests.y/coeff, ymax = pmin(cases.y, tests.y/coeff), fill = paste("Less than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
#                   labs(fill = "Positiv test procentage") +
#                   scale_x_continuous(breaks = scales::pretty_breaks(n = length(finland_all[,1]))) +
#                   scale_fill_manual(values=c("#009E73","firebrick3"), name="Amount of positive tests") +
#                   #geom_line(data=pred,aes(x = week, y = predictions, col="Prediction"), size=1.2, alpha = 0.7) + geom_text(data=tail(pred,future), aes(x = week, y = predictions, label=floor(predictions*coeff)), vjust=-0.8) +
#                   scale_colour_manual(name="Lines",breaks = c("Cases","Tests","Prediction"),values=c("009E73","firebrick3","purple"))
# tests_vs_cases
# Tests ----------------------------
#Women
#women <- prop.test(genders$val[1], genders$val[3],p = 0.5, alternative = "two.sided")
#paste("Womens are as likely to get corona as women with a 95-CI:",women$p.value>0.05)
#Men
#men <- prop.test(genders$val[2], genders$val[3],p = 0.5, alternative = "two.sided")
#paste("Men are as likely to get corona as women with a 95-CI:",men$p.value>0.05)
test <- ggplot(data = finland_all, aes(x = Week,Cases/Tests*100)) + geom_point(size=0.5) + geom_text(aes(label = paste0(round(Cases/Tests*100,1),"%")), vjust=-0.5)
#ggplotly(test)
# Hospitalized--------------------------
hospitalized <- hospitalized_raw %>%
mutate(date = as.Date(date)) %>%
filter(area == "Finland") %>%
mutate(week = week_fun(date)) %>%
gather("key", "value", c(inWard,inIcu)) %>%
filter(date > max(date)-60)
runApp('GitHub/COVID-19-analysis')
runApp('GitHub/COVID-19-analysis')
runApp('GitHub/COVID-19-analysis')
runApp('GitHub/COVID-19-analysis')
runApp('GitHub/COVID-19-analysis')
runApp('GitHub/COVID-19-analysis')
runApp('GitHub/COVID-19-analysis')
?reorder
runApp('GitHub/COVID-19-analysis')
reorder(finland_all$Week,finland_all$Index)
test <- reorder(finland_all$Week,finland_all$Index)
view(test)
test <- reorder(finland_all$Index,finland_all$Week)
warnings()
runApp('GitHub/COVID-19-analysis')
runApp('GitHub/COVID-19-analysis')
ggplot(data=finland_all, aes( x= Index, group = 1, ) ) +
geom_line(aes(y=Cases, col="Cases")) + geom_text(aes(label=Cases, y=Cases),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Cases)) +
geom_line(aes(y=Tests/coeff, col="Tests")) + geom_text(aes(label=Tests, y=Tests/coeff),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Tests/coeff), col = "firebrick3") +
scale_y_continuous(name = "Cases",sec.axis = sec_axis( trans=~.*coeff, name="Tests")) +
geom_ribbon(data=finland_all.interp, aes(x = tests.x, ymin = cases.y, ymax = pmin(cases.y, tests.y/coeff), fill = paste("More than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
geom_ribbon(data=finland_all.interp, aes(x = cases.x, ymin = tests.y/coeff, ymax = pmin(cases.y, tests.y/coeff), fill = paste("Less than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
labs(fill = "Positiv test procentage") +
scale_x_discrete(breaks = scales::pretty_breaks(n = length(finland_all[,1]))) +
annonate(geom = "text", x= Week) +
theme(axis.text.x = element_text(angle = 60)) +
scale_fill_manual(values=c("#009E73","firebrick3"), name="Amount of positive tests") +
#geom_line(data=pred,aes(x = week, y = predictions, col="Prediction"), size=1.2, alpha = 0.7) + geom_text(data=tail(pred,future), aes(x = week, y = predictions, label=floor(predictions*coeff)), vjust=-0.8) +
scale_colour_manual(name="Lines",breaks = c("Cases","Tests","Prediction"),values=c("009E73","firebrick3","purple"))
# Finland plots ----------
output$finland_tests <- renderPlot(
ggplot(data=finland_all, aes( x= Index, group = 1, ) ) +
geom_line(aes(y=Cases, col="Cases")) + geom_text(aes(label=Cases, y=Cases),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Cases)) +
geom_line(aes(y=Tests/coeff, col="Tests")) + geom_text(aes(label=Tests, y=Tests/coeff),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Tests/coeff), col = "firebrick3") +
scale_y_continuous(name = "Cases",sec.axis = sec_axis( trans=~.*coeff, name="Tests")) +
geom_ribbon(data=finland_all.interp, aes(x = tests.x, ymin = cases.y, ymax = pmin(cases.y, tests.y/coeff), fill = paste("More than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
geom_ribbon(data=finland_all.interp, aes(x = cases.x, ymin = tests.y/coeff, ymax = pmin(cases.y, tests.y/coeff), fill = paste("Less than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
labs(fill = "Positiv test procentage") +
scale_x_discrete(breaks = scales::pretty_breaks(n = length(finland_all[,1]))) +
annotate(geom = "text", x= Week) +
theme(axis.text.x = element_text(angle = 60)) +
scale_fill_manual(values=c("#009E73","firebrick3"), name="Amount of positive tests") +
#geom_line(data=pred,aes(x = week, y = predictions, col="Prediction"), size=1.2, alpha = 0.7) + geom_text(data=tail(pred,future), aes(x = week, y = predictions, label=floor(predictions*coeff)), vjust=-0.8) +
scale_colour_manual(name="Lines",breaks = c("Cases","Tests","Prediction"),values=c("009E73","firebrick3","purple"))
)
ggplot(data=finland_all, aes( x= Index, group = 1, ) ) +
geom_line(aes(y=Cases, col="Cases")) + geom_text(aes(label=Cases, y=Cases),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Cases)) +
geom_line(aes(y=Tests/coeff, col="Tests")) + geom_text(aes(label=Tests, y=Tests/coeff),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Tests/coeff), col = "firebrick3") +
scale_y_continuous(name = "Cases",sec.axis = sec_axis( trans=~.*coeff, name="Tests")) +
geom_ribbon(data=finland_all.interp, aes(x = tests.x, ymin = cases.y, ymax = pmin(cases.y, tests.y/coeff), fill = paste("More than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
geom_ribbon(data=finland_all.interp, aes(x = cases.x, ymin = tests.y/coeff, ymax = pmin(cases.y, tests.y/coeff), fill = paste("Less than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
labs(fill = "Positiv test procentage") +
scale_x_discrete(breaks = scales::pretty_breaks(n = length(finland_all[,1]))) +
annotate(geom = "text", x= Week)
ggplot(data=finland_all, aes( x= Index, group = 1, ) ) +
geom_line(aes(y=Cases, col="Cases")) + geom_text(aes(label=Cases, y=Cases),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Cases)) +
geom_line(aes(y=Tests/coeff, col="Tests")) + geom_text(aes(label=Tests, y=Tests/coeff),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Tests/coeff), col = "firebrick3") +
scale_y_continuous(name = "Cases",sec.axis = sec_axis( trans=~.*coeff, name="Tests")) +
geom_ribbon(data=finland_all.interp, aes(x = tests.x, ymin = cases.y, ymax = pmin(cases.y, tests.y/coeff), fill = paste("More than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
geom_ribbon(data=finland_all.interp, aes(x = cases.x, ymin = tests.y/coeff, ymax = pmin(cases.y, tests.y/coeff), fill = paste("Less than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
labs(fill = "Positiv test procentage") +
scale_x_discrete(breaks = scales::pretty_breaks(n = length(finland_all[,1]))) +
annotate(geom = "text", label = Week)
# Finland plots ----------
output$finland_tests <- renderPlot(
ggplot(data=finland_all, aes( x= Index, group = 1, ) ) +
geom_line(aes(y=Cases, col="Cases")) + geom_text(aes(label=Cases, y=Cases),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Cases)) +
geom_line(aes(y=Tests/coeff, col="Tests")) + geom_text(aes(label=Tests, y=Tests/coeff),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Tests/coeff), col = "firebrick3") +
scale_y_continuous(name = "Cases",sec.axis = sec_axis( trans=~.*coeff, name="Tests")) +
geom_ribbon(data=finland_all.interp, aes(x = tests.x, ymin = cases.y, ymax = pmin(cases.y, tests.y/coeff), fill = paste("More than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
geom_ribbon(data=finland_all.interp, aes(x = cases.x, ymin = tests.y/coeff, ymax = pmin(cases.y, tests.y/coeff), fill = paste("Less than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
labs(fill = "Positiv test procentage") +
scale_x_discrete(breaks = scales::pretty_breaks(n = length(finland_all[,1]))) +
annotate(geom = "text", label = finland_all$Week) +
theme(axis.text.x = element_text(angle = 60)) +
scale_fill_manual(values=c("#009E73","firebrick3"), name="Amount of positive tests") +
#geom_line(data=pred,aes(x = week, y = predictions, col="Prediction"), size=1.2, alpha = 0.7) + geom_text(data=tail(pred,future), aes(x = week, y = predictions, label=floor(predictions*coeff)), vjust=-0.8) +
scale_colour_manual(name="Lines",breaks = c("Cases","Tests","Prediction"),values=c("009E73","firebrick3","purple"))
)
ggplot(data=finland_all, aes( x= Index, group = 1, ) ) +
geom_line(aes(y=Cases, col="Cases")) + geom_text(aes(label=Cases, y=Cases),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Cases)) +
geom_line(aes(y=Tests/coeff, col="Tests")) + geom_text(aes(label=Tests, y=Tests/coeff),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Tests/coeff), col = "firebrick3") +
scale_y_continuous(name = "Cases",sec.axis = sec_axis( trans=~.*coeff, name="Tests")) +
geom_ribbon(data=finland_all.interp, aes(x = tests.x, ymin = cases.y, ymax = pmin(cases.y, tests.y/coeff), fill = paste("More than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
geom_ribbon(data=finland_all.interp, aes(x = cases.x, ymin = tests.y/coeff, ymax = pmin(cases.y, tests.y/coeff), fill = paste("Less than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
labs(fill = "Positiv test procentage") +
scale_x_discrete(breaks = scales::pretty_breaks(n = length(finland_all[,1]))) +
annotate(geom = "text", label = finland_all$Week)
ggplot(data=finland_all, aes( x= Index, group = 1, ) ) +
geom_line(aes(y=Cases, col="Cases")) + geom_text(aes(label=Cases, y=Cases),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Cases)) +
geom_line(aes(y=Tests/coeff, col="Tests")) + geom_text(aes(label=Tests, y=Tests/coeff),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Tests/coeff), col = "firebrick3") +
scale_y_continuous(name = "Cases",sec.axis = sec_axis( trans=~.*coeff, name="Tests")) +
geom_ribbon(data=finland_all.interp, aes(x = tests.x, ymin = cases.y, ymax = pmin(cases.y, tests.y/coeff), fill = paste("More than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
geom_ribbon(data=finland_all.interp, aes(x = cases.x, ymin = tests.y/coeff, ymax = pmin(cases.y, tests.y/coeff), fill = paste("Less than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
labs(fill = "Positiv test procentage") +
scale_x_discrete(breaks = scales::pretty_breaks(n = length(finland_all[,1]))) +
annotate(geom = "text", x = Index label = finland_all$Week) +
theme(axis.text.x = element_text(angle = 60)) +
scale_fill_manual(values=c("#009E73","firebrick3"), name="Amount of positive tests") +
#geom_line(data=pred,aes(x = week, y = predictions, col="Prediction"), size=1.2, alpha = 0.7) + geom_text(data=tail(pred,future), aes(x = week, y = predictions, label=floor(predictions*coeff)), vjust=-0.8) +
scale_colour_manual(name="Lines",breaks = c("Cases","Tests","Prediction"),values=c("009E73","firebrick3","purple"))
ggplot(data=finland_all, aes( x= Index, group = 1, ) ) +
geom_line(aes(y=Cases, col="Cases")) + geom_text(aes(label=Cases, y=Cases),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Cases)) +
geom_line(aes(y=Tests/coeff, col="Tests")) + geom_text(aes(label=Tests, y=Tests/coeff),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Tests/coeff), col = "firebrick3") +
scale_y_continuous(name = "Cases",sec.axis = sec_axis( trans=~.*coeff, name="Tests")) +
geom_ribbon(data=finland_all.interp, aes(x = tests.x, ymin = cases.y, ymax = pmin(cases.y, tests.y/coeff), fill = paste("More than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
geom_ribbon(data=finland_all.interp, aes(x = cases.x, ymin = tests.y/coeff, ymax = pmin(cases.y, tests.y/coeff), fill = paste("Less than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
labs(fill = "Positiv test procentage") +
scale_x_discrete(breaks = scales::pretty_breaks(n = length(finland_all[,1]))) +
annotate(geom = "text", x = Index, label = finland_all$Week)
ggplot(data=finland_all, aes( x= Index, group = 1, ) ) +
geom_line(aes(y=Cases, col="Cases")) + geom_text(aes(label=Cases, y=Cases),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Cases)) +
geom_line(aes(y=Tests/coeff, col="Tests")) + geom_text(aes(label=Tests, y=Tests/coeff),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Tests/coeff), col = "firebrick3") +
scale_y_continuous(name = "Cases",sec.axis = sec_axis( trans=~.*coeff, name="Tests")) +
geom_ribbon(data=finland_all.interp, aes(x = tests.x, ymin = cases.y, ymax = pmin(cases.y, tests.y/coeff), fill = paste("More than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
geom_ribbon(data=finland_all.interp, aes(x = cases.x, ymin = tests.y/coeff, ymax = pmin(cases.y, tests.y/coeff), fill = paste("Less than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
labs(fill = "Positiv test procentage") +
scale_x_discrete(breaks = scales::pretty_breaks(n = length(finland_all[,1]))) +
annotate(data =finland_all, = geom = "text", x = Index, label = Week)
ggplot(data=finland_all, aes( x= Index, group = 1, ) ) +
geom_line(aes(y=Cases, col="Cases")) + geom_text(aes(label=Cases, y=Cases),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Cases)) +
geom_line(aes(y=Tests/coeff, col="Tests")) + geom_text(aes(label=Tests, y=Tests/coeff),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Tests/coeff), col = "firebrick3") +
scale_y_continuous(name = "Cases",sec.axis = sec_axis( trans=~.*coeff, name="Tests")) +
geom_ribbon(data=finland_all.interp, aes(x = tests.x, ymin = cases.y, ymax = pmin(cases.y, tests.y/coeff), fill = paste("More than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
geom_ribbon(data=finland_all.interp, aes(x = cases.x, ymin = tests.y/coeff, ymax = pmin(cases.y, tests.y/coeff), fill = paste("Less than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
labs(fill = "Positiv test procentage") +
scale_x_discrete(breaks = scales::pretty_breaks(n = length(finland_all[,1]))) +
annotate(data = finland_all, geom = "text", x = Index, label = Week)
ggplot(data=finland_all, aes( x= Index, group = 1, ) ) +
geom_line(aes(y=Cases, col="Cases")) + geom_text(aes(label=Cases, y=Cases),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Cases)) +
geom_line(aes(y=Tests/coeff, col="Tests")) + geom_text(aes(label=Tests, y=Tests/coeff),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Tests/coeff), col = "firebrick3") +
scale_y_continuous(name = "Cases",sec.axis = sec_axis( trans=~.*coeff, name="Tests")) +
geom_ribbon(data=finland_all.interp, aes(x = tests.x, ymin = cases.y, ymax = pmin(cases.y, tests.y/coeff), fill = paste("More than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
geom_ribbon(data=finland_all.interp, aes(x = cases.x, ymin = tests.y/coeff, ymax = pmin(cases.y, tests.y/coeff), fill = paste("Less than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
labs(fill = "Positiv test procentage") +
scale_x_discrete(breaks = scales::pretty_breaks(n = length(finland_all[,1]))) +
annotate(geom = "text", x = finland_all$Index, label = finland_all$Week)
?geom_text
?axis.text
?theme
ggplot(data=finland_all, aes( x= Index, group = 1, ) ) +
geom_line(aes(y=Cases, col="Cases")) + geom_text(aes(label=Cases, y=Cases),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Cases)) +
geom_line(aes(y=Tests/coeff, col="Tests")) + geom_text(aes(label=Tests, y=Tests/coeff),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Tests/coeff), col = "firebrick3") +
scale_y_continuous(name = "Cases",sec.axis = sec_axis( trans=~.*coeff, name="Tests")) +
geom_ribbon(data=finland_all.interp, aes(x = tests.x, ymin = cases.y, ymax = pmin(cases.y, tests.y/coeff), fill = paste("More than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
geom_ribbon(data=finland_all.interp, aes(x = cases.x, ymin = tests.y/coeff, ymax = pmin(cases.y, tests.y/coeff), fill = paste("Less than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
labs(fill = "Positiv test procentage") +
scale_x_discrete(breaks = scales::pretty_breaks(n = length(finland_all[,1]))) +
theme(axis.text = Week, axis.text.x = element_text(angle = 60))
ggplot(data=finland_all, aes( x= Index, group = 1, ) ) +
geom_line(aes(y=Cases, col="Cases")) + geom_text(aes(label=Cases, y=Cases),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Cases)) +
geom_line(aes(y=Tests/coeff, col="Tests")) + geom_text(aes(label=Tests, y=Tests/coeff),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Tests/coeff), col = "firebrick3") +
scale_y_continuous(name = "Cases",sec.axis = sec_axis( trans=~.*coeff, name="Tests")) +
geom_ribbon(data=finland_all.interp, aes(x = tests.x, ymin = cases.y, ymax = pmin(cases.y, tests.y/coeff), fill = paste("More than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
geom_ribbon(data=finland_all.interp, aes(x = cases.x, ymin = tests.y/coeff, ymax = pmin(cases.y, tests.y/coeff), fill = paste("Less than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
labs(fill = "Positiv test procentage") +
scale_x_discrete(breaks = scales::pretty_breaks(n = length(finland_all[,1]))) +
theme(axis.text.x = element_text(finland_all$week, angle = 60))
ggplot(data=finland_all, aes( x= Index, group = 1, ) ) +
geom_line(aes(y=Cases, col="Cases")) + geom_text(aes(label=Cases, y=Cases),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Cases)) +
geom_line(aes(y=Tests/coeff, col="Tests")) + geom_text(aes(label=Tests, y=Tests/coeff),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Tests/coeff), col = "firebrick3") +
scale_y_continuous(name = "Cases",sec.axis = sec_axis( trans=~.*coeff, name="Tests")) +
geom_ribbon(data=finland_all.interp, aes(x = tests.x, ymin = cases.y, ymax = pmin(cases.y, tests.y/coeff), fill = paste("More than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
geom_ribbon(data=finland_all.interp, aes(x = cases.x, ymin = tests.y/coeff, ymax = pmin(cases.y, tests.y/coeff), fill = paste("Less than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
labs(fill = "Positiv test procentage") +
scale_x_discrete(breaks = scales::pretty_breaks(n = length(finland_all[,1]))) +
theme(axis.text.x = element_text(finland_all$week, angle = 60)) +
scale_fill_manual(values=c("#009E73","firebrick3"), name="Amount of positive tests") +
#geom_line(data=pred,aes(x = week, y = predictions, col="Prediction"), size=1.2, alpha = 0.7) + geom_text(data=tail(pred,future), aes(x = week, y = predictions, label=floor(predictions*coeff)), vjust=-0.8) +
scale_colour_manual(name="Lines",breaks = c("Cases","Tests","Prediction"),values=c("009E73","firebrick3","purple"))
ggplot(data=finland_all, aes( x= Index, group = 1, ) ) +
geom_line(aes(y=Cases, col="Cases")) + geom_text(aes(label=Cases, y=Cases),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Cases)) +
geom_line(aes(y=Tests/coeff, col="Tests")) + geom_text(aes(label=Tests, y=Tests/coeff),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Tests/coeff), col = "firebrick3") +
scale_y_continuous(name = "Cases",sec.axis = sec_axis( trans=~.*coeff, name="Tests")) +
geom_ribbon(data=finland_all.interp, aes(x = tests.x, ymin = cases.y, ymax = pmin(cases.y, tests.y/coeff), fill = paste("More than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
geom_ribbon(data=finland_all.interp, aes(x = cases.x, ymin = tests.y/coeff, ymax = pmin(cases.y, tests.y/coeff), fill = paste("Less than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
labs(fill = "Positiv test procentage") +
scale_x_discrete(breaks = scales::pretty_breaks(n = length(finland_all[,1])), labels= Week)
ggplot(data=finland_all, aes( x= Index, group = 1, ) ) +
geom_line(aes(y=Cases, col="Cases")) + geom_text(aes(label=Cases, y=Cases),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Cases)) +
geom_line(aes(y=Tests/coeff, col="Tests")) + geom_text(aes(label=Tests, y=Tests/coeff),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Tests/coeff), col = "firebrick3") +
scale_y_continuous(name = "Cases",sec.axis = sec_axis( trans=~.*coeff, name="Tests")) +
geom_ribbon(data=finland_all.interp, aes(x = tests.x, ymin = cases.y, ymax = pmin(cases.y, tests.y/coeff), fill = paste("More than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
geom_ribbon(data=finland_all.interp, aes(x = cases.x, ymin = tests.y/coeff, ymax = pmin(cases.y, tests.y/coeff), fill = paste("Less than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
labs(fill = "Positiv test procentage") +
scale_x_discrete(breaks = scales::pretty_breaks(n = length(finland_all[,1])), labels= finland_all$Week)
ggplot(data=finland_all, aes( x= Index, group = 1, ) ) +
geom_line(aes(y=Cases, col="Cases")) + geom_text(aes(label=Cases, y=Cases),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Cases)) +
geom_line(aes(y=Tests/coeff, col="Tests")) + geom_text(aes(label=Tests, y=Tests/coeff),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Tests/coeff), col = "firebrick3") +
scale_y_continuous(name = "Cases",sec.axis = sec_axis( trans=~.*coeff, name="Tests")) +
geom_ribbon(data=finland_all.interp, aes(x = tests.x, ymin = cases.y, ymax = pmin(cases.y, tests.y/coeff), fill = paste("More than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
geom_ribbon(data=finland_all.interp, aes(x = cases.x, ymin = tests.y/coeff, ymax = pmin(cases.y, tests.y/coeff), fill = paste("Less than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
labs(fill = "Positiv test procentage") +
scale_x_continuous(breaks = scales::pretty_breaks(n = length(finland_all[,1])), labels= finland_all$Week)
finland_all[,1]
length(finland_all[,1]))
length(finland_all[,1])
length(finland_all$Week)
scales::pretty_breaks(n =length(finland_all[,1]))
ggplot(data=finland_all, aes( x= Index, group = 1, ) ) +
geom_line(aes(y=Cases, col="Cases")) + geom_text(aes(label=Cases, y=Cases),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Cases)) +
geom_line(aes(y=Tests/coeff, col="Tests")) + geom_text(aes(label=Tests, y=Tests/coeff),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Tests/coeff), col = "firebrick3") +
scale_y_continuous(name = "Cases",sec.axis = sec_axis( trans=~.*coeff, name="Tests")) +
geom_ribbon(data=finland_all.interp, aes(x = tests.x, ymin = cases.y, ymax = pmin(cases.y, tests.y/coeff), fill = paste("More than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
geom_ribbon(data=finland_all.interp, aes(x = cases.x, ymin = tests.y/coeff, ymax = pmin(cases.y, tests.y/coeff), fill = paste("Less than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
labs(fill = "Positiv test procentage") +
scale_x_continuous(breaks = scales='free_x', labels= finland_all$Week)
scales::pretty_breaks(n =length(finland_all[,1]))
ggplot(data=finland_all, aes( x= Index, group = 1, ) ) +
geom_line(aes(y=Cases, col="Cases")) + geom_text(aes(label=Cases, y=Cases),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Cases)) +
geom_line(aes(y=Tests/coeff, col="Tests")) + geom_text(aes(label=Tests, y=Tests/coeff),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Tests/coeff), col = "firebrick3") +
scale_y_continuous(name = "Cases",sec.axis = sec_axis( trans=~.*coeff, name="Tests")) +
geom_ribbon(data=finland_all.interp, aes(x = tests.x, ymin = cases.y, ymax = pmin(cases.y, tests.y/coeff), fill = paste("More than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
geom_ribbon(data=finland_all.interp, aes(x = cases.x, ymin = tests.y/coeff, ymax = pmin(cases.y, tests.y/coeff), fill = paste("Less than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
labs(fill = "Positiv test procentage") +
scale_x_continuous(breaks = scales::pretty_breaks(n =length(finland_all[,1])), labels = finland_all$Week)
ggplot(data=finland_all, aes( x= Index, group = 1, ) ) +
geom_line(aes(y=Cases, col="Cases")) + geom_text(aes(label=Cases, y=Cases),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Cases)) +
geom_line(aes(y=Tests/coeff, col="Tests")) + geom_text(aes(label=Tests, y=Tests/coeff),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Tests/coeff), col = "firebrick3") +
scale_y_continuous(name = "Cases",sec.axis = sec_axis( trans=~.*coeff, name="Tests")) +
geom_ribbon(data=finland_all.interp, aes(x = tests.x, ymin = cases.y, ymax = pmin(cases.y, tests.y/coeff), fill = paste("More than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
geom_ribbon(data=finland_all.interp, aes(x = cases.x, ymin = tests.y/coeff, ymax = pmin(cases.y, tests.y/coeff), fill = paste("Less than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
labs(fill = "Positiv test procentage") +
scale_x_continuous(breaks = scales::pretty_breaks(n =length(finland_all[,1])))
ggplot(data=finland_all, aes( x= reorder(Week,Index), group = 1, ) ) +
geom_line(aes(y=Cases, col="Cases")) + geom_text(aes(label=Cases, y=Cases),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Cases)) +
geom_line(aes(y=Tests/coeff, col="Tests")) + geom_text(aes(label=Tests, y=Tests/coeff),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Tests/coeff), col = "firebrick3") +
scale_y_continuous(name = "Cases",sec.axis = sec_axis( trans=~.*coeff, name="Tests")) +
geom_ribbon(data=finland_all.interp, aes(x = tests.x, ymin = cases.y, ymax = pmin(cases.y, tests.y/coeff), fill = paste("More than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
geom_ribbon(data=finland_all.interp, aes(x = cases.x, ymin = tests.y/coeff, ymax = pmin(cases.y, tests.y/coeff), fill = paste("Less than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
labs(fill = "Positiv test procentage") +
scale_x_continuous(breaks = scales::pretty_breaks(n =length(finland_all[,1]))) +
theme(axis.text.x = element_text(angle = 60))
ggplot(data=finland_all, aes( x= reorder(Week,Index), group = 1, ) ) +
geom_line(aes(y=Cases, col="Cases")) + geom_text(aes(label=Cases, y=Cases),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Cases)) +
geom_line(aes(y=Tests/coeff, col="Tests")) + geom_text(aes(label=Tests, y=Tests/coeff),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Tests/coeff), col = "firebrick3") +
scale_y_continuous(name = "Cases",sec.axis = sec_axis( trans=~.*coeff, name="Tests")) +
geom_ribbon(data=finland_all.interp, aes(x = tests.x, ymin = cases.y, ymax = pmin(cases.y, tests.y/coeff), fill = paste("More than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
geom_ribbon(data=finland_all.interp, aes(x = cases.x, ymin = tests.y/coeff, ymax = pmin(cases.y, tests.y/coeff), fill = paste("Less than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
labs(fill = "Positiv test procentage") +
scale_x_discrete(breaks = scales::pretty_breaks(n =length(finland_all[,1])))
ggplot(data=finland_all, aes( x= reorder(Week,Index), group = 1, ) ) +
geom_line(aes(y=Cases, col="Cases")) + geom_text(aes(label=Cases, y=Cases),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Cases)) +
geom_line(aes(y=Tests/coeff, col="Tests")) + geom_text(aes(label=Tests, y=Tests/coeff),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Tests/coeff), col = "firebrick3") +
scale_y_continuous(name = "Cases",sec.axis = sec_axis( trans=~.*coeff, name="Tests")) +
geom_ribbon(data=finland_all.interp, aes(x = tests.x, ymin = cases.y, ymax = pmin(cases.y, tests.y/coeff), fill = paste("More than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
geom_ribbon(data=finland_all.interp, aes(x = cases.x, ymin = tests.y/coeff, ymax = pmin(cases.y, tests.y/coeff), fill = paste("Less than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
labs(fill = "Positiv test procentage") +
scale_x_discrete(breaks = scales::pretty_breaks(n =length(finland_all[,1]))) +
theme(axis.text.x = element_text(angle = 60))
ggplot(data=finland_all, aes( x= Index, group = 1, ) ) +
geom_line(aes(y=Cases, col="Cases")) + geom_text(aes(label=Cases, y=Cases),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Cases)) +
geom_line(aes(y=Tests/coeff, col="Tests")) + geom_text(aes(label=Tests, y=Tests/coeff),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Tests/coeff), col = "firebrick3") +
scale_y_continuous(name = "Cases",sec.axis = sec_axis( trans=~.*coeff, name="Tests")) +
geom_ribbon(data=finland_all.interp, aes(x = tests.x, ymin = cases.y, ymax = pmin(cases.y, tests.y/coeff), fill = paste("More than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
geom_ribbon(data=finland_all.interp, aes(x = cases.x, ymin = tests.y/coeff, ymax = pmin(cases.y, tests.y/coeff), fill = paste("Less than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
labs(fill = "Positiv test procentage") +
scale_x_continuous(breaks = scales::pretty_breaks(n =length(finland_all[,1]))) +
theme(axis.text.x = element_text(angle = 60))
ggplot(data=finland_all, aes( x= Index, group = 1, ) ) +
geom_line(aes(y=Cases, col="Cases")) + geom_text(aes(label=Cases, y=Cases),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Cases)) +
geom_line(aes(y=Tests/coeff, col="Tests")) + geom_text(aes(label=Tests, y=Tests/coeff),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Tests/coeff), col = "firebrick3") +
scale_y_continuous(name = "Cases",sec.axis = sec_axis( trans=~.*coeff, name="Tests")) +
geom_ribbon(data=finland_all.interp, aes(x = tests.x, ymin = cases.y, ymax = pmin(cases.y, tests.y/coeff), fill = paste("More than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
geom_ribbon(data=finland_all.interp, aes(x = cases.x, ymin = tests.y/coeff, ymax = pmin(cases.y, tests.y/coeff), fill = paste("Less than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
labs(fill = "Positiv test procentage") +
#scale_x_continuous(breaks = scales::pretty_breaks(n =length(finland_all[,1]))) +
theme(axis.text.x = element_text(angle = 60))
ggplot(data=finland_all, aes( x= Index, group = 1, ) ) +
geom_line(aes(y=Cases, col="Cases")) + geom_text(aes(label=Cases, y=Cases),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Cases)) +
geom_line(aes(y=Tests/coeff, col="Tests")) + geom_text(aes(label=Tests, y=Tests/coeff),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Tests/coeff), col = "firebrick3") +
scale_y_continuous(name = "Cases",sec.axis = sec_axis( trans=~.*coeff, name="Tests")) +
geom_ribbon(data=finland_all.interp, aes(x = tests.x, ymin = cases.y, ymax = pmin(cases.y, tests.y/coeff), fill = paste("More than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
geom_ribbon(data=finland_all.interp, aes(x = cases.x, ymin = tests.y/coeff, ymax = pmin(cases.y, tests.y/coeff), fill = paste("Less than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
labs(fill = "Positiv test procentage") +
scale_x_continuous(labels = Week) +
theme(axis.text.x = element_text(angle = 60))
ggplot(data=finland_all, aes( x= Index, group = 1, ) ) +
geom_line(aes(y=Cases, col="Cases")) + geom_text(aes(label=Cases, y=Cases),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Cases)) +
geom_line(aes(y=Tests/coeff, col="Tests")) + geom_text(aes(label=Tests, y=Tests/coeff),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Tests/coeff), col = "firebrick3") +
scale_y_continuous(name = "Cases",sec.axis = sec_axis( trans=~.*coeff, name="Tests")) +
geom_ribbon(data=finland_all.interp, aes(x = tests.x, ymin = cases.y, ymax = pmin(cases.y, tests.y/coeff), fill = paste("More than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
geom_ribbon(data=finland_all.interp, aes(x = cases.x, ymin = tests.y/coeff, ymax = pmin(cases.y, tests.y/coeff), fill = paste("Less than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
labs(fill = "Positiv test procentage") +
scale_x_continuous(labels = finland_all$Week)
runApp('GitHub/COVID-19-analysis')
View(finland)
date(Year 2020 Week 03)
date("Year 2020 Week 03"")
date("Year 2020 Week 03")
?pretty_breaks
ggplot(data=finland_all, aes( x= Index, group = 1, ) ) +
geom_line(aes(y=Cases, col="Cases")) + geom_text(aes(label=Cases, y=Cases),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Cases)) +
geom_line(aes(y=Tests/coeff, col="Tests")) + geom_text(aes(label=Tests, y=Tests/coeff),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Tests/coeff), col = "firebrick3") +
scale_y_continuous(name = "Cases",sec.axis = sec_axis( trans=~.*coeff, name="Tests")) +
geom_ribbon(data=finland_all.interp, aes(x = tests.x, ymin = cases.y, ymax = pmin(cases.y, tests.y/coeff), fill = paste("More than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
geom_ribbon(data=finland_all.interp, aes(x = cases.x, ymin = tests.y/coeff, ymax = pmin(cases.y, tests.y/coeff), fill = paste("Less than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
labs(fill = "Positiv test procentage") +
scale_x_continuous(breaks = length(finland_all[,1]), labels = Week)
shiny::runApp('GitHub/COVID-19-analysis')
ggplot(data=finland_all, aes( x= Index, group = 1, ) ) +
geom_line(aes(y=Cases, col="Cases")) + geom_text(aes(label=Cases, y=Cases),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Cases)) +
geom_line(aes(y=Tests/coeff, col="Tests")) + geom_text(aes(label=Tests, y=Tests/coeff),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Tests/coeff), col = "firebrick3") +
scale_y_continuous(name = "Cases",sec.axis = sec_axis( trans=~.*coeff, name="Tests")) +
geom_ribbon(data=finland_all.interp, aes(x = tests.x, ymin = cases.y, ymax = pmin(cases.y, tests.y/coeff), fill = paste("More than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
geom_ribbon(data=finland_all.interp, aes(x = cases.x, ymin = tests.y/coeff, ymax = pmin(cases.y, tests.y/coeff), fill = paste("Less than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
labs(fill = "Positiv test procentage") +
scale_x_continuous(breaks = length(finland_all[,1]), labels = finland_all$Week)
ggplot(data=finland_all, aes( x= Index, group = 1, ) ) +
geom_line(aes(y=Cases, col="Cases")) + geom_text(aes(label=Cases, y=Cases),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Cases)) +
geom_line(aes(y=Tests/coeff, col="Tests")) + geom_text(aes(label=Tests, y=Tests/coeff),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Tests/coeff), col = "firebrick3") +
scale_y_continuous(name = "Cases",sec.axis = sec_axis( trans=~.*coeff, name="Tests")) +
geom_ribbon(data=finland_all.interp, aes(x = tests.x, ymin = cases.y, ymax = pmin(cases.y, tests.y/coeff), fill = paste("More than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
geom_ribbon(data=finland_all.interp, aes(x = cases.x, ymin = tests.y/coeff, ymax = pmin(cases.y, tests.y/coeff), fill = paste("Less than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
labs(fill = "Positiv test procentage") +
scale_x_continuous(breaks = 1:length(finland_all[,1]), labels = finland_all$Week)
ggplot(data=finland_all, aes( x= Index, group = 1, ) ) +
geom_line(aes(y=Cases, col="Cases")) + geom_text(aes(label=Cases, y=Cases),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Cases)) +
geom_line(aes(y=Tests/coeff, col="Tests")) + geom_text(aes(label=Tests, y=Tests/coeff),hjust=1.2, vjust=-0.6) + geom_point(aes(y=Tests/coeff), col = "firebrick3") +
scale_y_continuous(name = "Cases",sec.axis = sec_axis( trans=~.*coeff, name="Tests")) +
geom_ribbon(data=finland_all.interp, aes(x = tests.x, ymin = cases.y, ymax = pmin(cases.y, tests.y/coeff), fill = paste("More than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
geom_ribbon(data=finland_all.interp, aes(x = cases.x, ymin = tests.y/coeff, ymax = pmin(cases.y, tests.y/coeff), fill = paste("Less than ",1/coeff*100,"%", sep = "")), alpha=0.5) +
labs(fill = "Positiv test procentage") +
scale_x_continuous(breaks = 1:length(finland_all[,1]), labels = finland_all$Week) +
theme(axis.text.x = element_text(angle = 60)) +
scale_fill_manual(values=c("#009E73","firebrick3"), name="Amount of positive tests") +
#geom_line(data=pred,aes(x = week, y = predictions, col="Prediction"), size=1.2, alpha = 0.7) + geom_text(data=tail(pred,future), aes(x = week, y = predictions, label=floor(predictions*coeff)), vjust=-0.8) +
scale_colour_manual(name="Lines",breaks = c("Cases","Tests","Prediction"),values=c("009E73","firebrick3","purple"))
runApp('GitHub/COVID-19-analysis')
runApp('GitHub/COVID-19-analysis')
runApp('GitHub/COVID-19-analysis')
runApp('GitHub/COVID-19-analysis')
append(1:9,1:length(finland_all[,1]))
runApp('GitHub/COVID-19-analysis')
runApp('GitHub/COVID-19-analysis')
runApp('GitHub/COVID-19-analysis')
runApp('GitHub/COVID-19-analysis')
runApp('GitHub/COVID-19-analysis')
runApp('GitHub/COVID-19-analysis')
runApp('GitHub/COVID-19-analysis')
runApp('GitHub/COVID-19-analysis')
runApp('GitHub/COVID-19-analysis')
runApp('GitHub/COVID-19-analysis')
runApp('GitHub/COVID-19-analysis')
runApp('GitHub/COVID-19-analysis')
runApp('GitHub/COVID-19-analysis')
runApp('GitHub/COVID-19-analysis')
cos(1/500)
runApp('GitHub/COVID-19-analysis')
runApp('GitHub/COVID-19-analysis')
runApp('GitHub/COVID-19-analysis')
runApp('GitHub/COVID-19-analysis')
runApp('GitHub/COVID-19-analysis')
runApp('GitHub/COVID-19-analysis')
runApp('GitHub/COVID-19-analysis')
runApp('GitHub/COVID-19-analysis')
runApp('GitHub/COVID-19-analysis')
runApp('GitHub/COVID-19-analysis')
shiny::runApp('GitHub/COVID-19-analysis')
matrix(c(1,0,0.5,0,1,0.8),byrow=T,ncol=2)
matrix(c(1,0,0.5,0,1,0.8),byrow=T,ncol=3)
matrix(c(1,0,0.5,0,1,0.8,0.5,0.8,1),byrow=T,ncol=3)
A <- matrix(c(1,0,0.5,0,1,0.8,0.5,0.8,1),byrow=T,ncol=3)
eigen(A)
A <- matrix(c(0,0,0.5,0,1,0.8,0.5,0.8,1),byrow=T,ncol=3)
eigen(A)
shiny::runApp('GitHub/COVID-19-analysis')
View(finland)
View(finland_all)
View(finland_all)
runApp('GitHub/COVID-19-analysis')
runApp('GitHub/COVID-19-analysis')
runApp('GitHub/COVID-19-analysis')
shiny::runApp('GitHub/COVID-19-analysis')
runApp('GitHub/COVID-19-analysis')
runApp('GitHub/COVID-19-analysis')
runApp('GitHub/COVID-19-analysis')
runApp('GitHub/COVID-19-analysis')
runApp('GitHub/COVID-19-analysis')
runApp('GitHub/COVID-19-analysis')
install.packages('IRkernel')
IRkernel::installspec(user = FALSE)
install.packages('IRkernel')
install.packages("IRkernel")
IRkernel::installspec(user = FALSE)
knitr::opts_chunk$set(echo = TRUE)
rm(list = ls())
p_red = function(boxes){
P_A = 0.4
P_B = 0.1
P_C = 1 - P_A - P_B
P_red_con_A = boxes[1,1]/rowSums(boxes)[1]
P_red_con_B = boxes[2,1]/rowSums(boxes)[2]
P_red_con_C = boxes[3,1]/rowSums(boxes)[3]
res = P_red_con_A*P_A + P_B*P_red_con_B + P_red_con_C * P_C
return(res)
}
boxes <- matrix(c(2,4,1,5,1,3), ncol = 2,dimnames = list(c("A", "B", "C"), c("red", "white")))
p_red(boxes = boxes)
p_box = function(boxes){
P_A = 0.4
P_B = 0.1
P_C = 1 - P_A - P_B
P_red_res = p_red(boxes = boxes)
P_red_con_A = boxes[1,1]/rowSums(boxes)[1]
P_red_con_B = boxes[2,1]/rowSums(boxes)[2]
P_red_con_C = boxes[3,1]/rowSums(boxes)[3]
P_A_con_red = P_red_con_A * P_A / P_red_res
P_B_con_red = P_red_con_B * P_B / P_red_res
P_C_con_red = P_red_con_C * P_C / P_red_res
res = c(P_A_con_red,P_B_con_red,P_C_con_red)
return(res)
}
p_box(boxes = boxes)
setwd("~/")
setwd("~/GitHub/Beysian-Data-Analysis-course-F2021/Assignment 1")
knitr::opts_chunk$set(echo = TRUE)
CI95=quantile(sample,probs=c(0.025,0.975))
123
